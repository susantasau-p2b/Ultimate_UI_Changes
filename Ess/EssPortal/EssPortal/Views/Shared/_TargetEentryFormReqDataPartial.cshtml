@{
    Layout = null;
}
@model EssPortal.Models.FileModel
<html>
<head>
<style>
    .popup-content-label {
        width: 111px;
        display: block;
        float: left;
    }

    .row1 {
        width: 635px;
        display: inline-block;
    }

    .hide_textbox {
        display: none;
    }

    .container_div {
        border: 1px solid rgba(207, 207, 207, 0.91);
        margin-top: 15px;
        margin-bottom: 15px;
    }

    .section1_Leave {
        display: block;
        border: 1.5px solid rgba(207, 207, 207, 0.91);
        height: 554px;
        width: 534px;
        margin: 4px auto;
        position: absolute;
    }

    .section2_Leave {
        display: block;
        border: 1px solid #ddd;
        height: 554px;
        width: 610px;
        margin: 5px 4px;
        position: absolute;
        left: 546px;
    }

    .hide-div {
        display: none;
    }

    .header-title {
        display: block;
        height: 315px;
        width: 610px;
    }

    .heading {
        background: rgba(207, 207, 207, 0.91) none repeat scroll 0 0;
        color: #424242;
        display: block;
        font-size: 1em;
        font-weight: bold;
        height: 15px;
        margin: 3px auto;
        padding: 2px 0 1px 2px;
        width: 99%;
    }

    .hide-div {
        display: none;
    }

    .lv-label {
        width: 125px;
        font-size: 9px;
        padding: 1px;
        position: relative;
        float: left;
    }

    .lb-data {
        font-weight: bold;
        font-size: 11px;
        float: left;
    }

    .imgdata {
        width: 100%;
        height: 100%;
    }
    #monthTable {
        /*font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;*/
        border-collapse: collapse;
        width: 100%;
    }

        #monthTable td, #monthTable th {
            border: 1px solid #ddd;
            padding: 8px;
        }
    .monthTable-selected {
        color: #8e6d87;
        font-weight: bold;
    }
    /*#monthTable tr:nth-child(even) {
            background-color: #f2f2f2;
        }*/

    #monthTable tr:hover {
        background-color: #ddd;
    }

    #monthTable th {
        padding-top: 12px;
        padding-bottom: 12px;
        text-align: left;
        background-color: #009282;
        color: white;
    }
</style>
</head>

<body>
    <form id="TargetEntryFormNeedReqPartial" name="TargetEntryFormNeedReqPartial" method="post">

        <input type="text" class="hide_textbox" name="authority" id="authority" />
        <input type="text" class="hide_textbox" name="isClose" id="isClose" />
        <input type="text" class="hide_textbox" name="EmpDataTar" id="EmpDataTar" />
       
           <div>
                <table id="monthTable">
                    <tr><th>Sr.No</th><th><input type="checkbox" id="select_all" /></th><th>Category</th><th>SubCategory</th><th>Amount</th><th>Account</th><th>Compliance</th><th>Narration</th><th>CustomerId</th><th>AccountNo</th><th>Id</th></tr>
                </table>
            </div>
        <div class="section_Method" id="lv-div" style="display:block">
            <br><br><br>
            <div class="row1 content_margine hide-div" id="SanctionReasonDiv">
                <label class="lv-label">Sanction Reason:</label>
                <div id="lvSanctionReason" class="lb-data"></div>
            </div>
            <div class="row1 content_margine hide-div" id="ApprovalReasonDiv">
                <label class="lv-label">Approval Reason:</label>
                <div id="lvApprovalReason" class="lb-data"></div>
            </div>
            <div class="section_Method hide-div" id="MySelf-div">
                <div id="MySelfDiv">
                    <div class="heading">MySelf Authority Views</div>
                    <div id="yes_no_div" class="row1 content_margine">
                        <label class="popup-content-label">
                            Is Cancel:
                        </label>
                        <div class="popup_radio_button">
                            <input type="radio" name="IsCancel" value="true" id="rdo5" /><label for="rdo5">Yes</label>
                            <input type="radio" name="IsCancel" id="rdo6" value="false" /><label for="rdo6">No</label>
                        </div>
                    </div>
                    <div class="row1 content_margine">
                        <label class="popup-content-label">Reason :</label>
                        <input type="text" id="Grid-ReasonIsCancel" name="ReasonIsCancel" />
                    </div>
                </div>
            </div>
            <div class="section_Method hide-div" id="Sanction-div">
                <div id="SanctionDiv">
                    <div class="heading">Sanction Authority Views</div>
                    <div id="yes_no_div" class="row1 content_margine">
                        <label class="popup-content-label must">
                            Sanction Status:
                        </label>
                        <div class="popup_radio_button">
                            <input type="radio" name="Sanction" value="true" id="rdo1" /><label for="rdo1">Yes</label>
                            <input type="radio" name="Sanction" id="rdo2" value="false" /><label for="rdo2">No</label>
                        </div>
                    </div>

                    <div class="row1 content_margine">
                        <label class="popup-content-label must">Reason :</label>
                        <input type="text" id="Grid-ReasonSanction" name="ReasonSanction" />
                    </div>

                    @*<div>
                        <input type="submit" id="SanctionAll" name="SanctionAll"  />
                    </div>*@
                </div>
            </div>
            <div class="section_Method hide-div" id="Approval-div">
                <div id="ApprovalDiv" class="row1 content_margine">
                    <div class="heading">Approval Authority View</div>
                    <label class="popup-content-label must">
                        Approval Status:
                    </label>
                    <div class="popup_radio_button">
                        <input type="radio" name="Approval" value="true" id="rdo3" /><label for="rdo3">Yes</label>
                        <input type="radio" name="Approval" id="rdo4" value="false" /><label for="rdo4">No</label>
                    </div>
                    <div class="row1 content_margine">
                        <label class="popup-content-label must">Reason :</label>
                        <input type="text" id="Grid-ReasonApproval" name="ReasonApproval" />
                    </div>
                </div>
            </div>
            <div class="form-horizontal" id="Upload_Div">
                <div class="form-group content_margine" id="FileBrowes_id">
                    @Html.LabelFor(model => model.files, htmlAttributes: new { @class = "control-label popup-content-label" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(model => model.files, "", new { @type = "file", @multiple = "multiple" }) <button id="Upload_btnUser" name="Upload_btnUser">Upload</button> @*<button id="Download_File" name="Download_File">Download</button>*@
                    </div>
                </div>
                <div class="row3 content_margine" id="FileDownload_idUser">
                    <label class="popup-content-label">File Download :</label><input type="text" class="popup-content-textbox" id="filepathiduser" /> <button id="Download_btnUser" name="Download_btnUser">Download</button>
                </div>
                <div style="height:100%;width:100%;overflow:auto;" id="user_investment" class="content_margine"></div>
                <canvas id="pdfViewer"></canvas>
                <div id="container2" class="container2">
                </div>
            </div>

            <button type="button" id="save">Save</button>
        </div>
        
</form>

</body>
</html>
<script>
    $(document).ready(function (e) {
        $('button').button();
        $('.popup_radio_button').buttonset();
       
        console.log($.LocalStorageHelper.Get("Whois"));
        if ($.LocalStorageHelper.Get("Whois").toUpperCase() == "SANCTION".toUpperCase()) {
            $('#Sanction-div').show();
            $('#SanctionReasonDiv,#ApprovalReasonDiv').hide();
            $('#Upload_Div').hide();
            $('#authority').val($.LocalStorageHelper.Get("Whois"));
        } else {
            $('#Sanction-div').hide();
        }
        if ($.LocalStorageHelper.Get("Whois").toUpperCase() == "MySelf".toUpperCase()) {
            $('#MySelf-div').show();
            // $('#MySelfReasonDiv,#ApprovalReasonDiv').hide();
            $('#SanctionReasonDiv,#ApprovalReasonDiv').show();
            $('#authority').val($.LocalStorageHelper.Get("Whois"));
        } else {
            // $('#Sanction-div').hide();
        }
        if ($.LocalStorageHelper.Get("Whois").toUpperCase() == "ReComandtion".toUpperCase()) {
            $('#ReComandtion-div').show();
            $('#authority').val($.LocalStorageHelper.Get("Whois"));
        } else {
            $('#ReComandtion-div').hide();
        }
        if ($.LocalStorageHelper.Get("Whois").toUpperCase() == "Approval".toUpperCase()) {
            $('#Sanction-div').hide();
            $('#Approval-div').show();
            $('#SanctionReasonDiv,#ApprovalReasonDiv').hide();
            $('#Upload_Div').hide();
            $('#authority').val($.LocalStorageHelper.Get("Whois"));
        } else {
            $('#Approval-div').hide();
        }

        if ($.LocalStorageHelper.Get("Whois").toUpperCase() == "HR".toUpperCase()) {
            $('#HR-div').show();

            $('#authority').val($.LocalStorageHelper.Get("Whois"));
        } else {
            $('#HR-div').hide();
        }
        if ($.LocalStorageHelper.Get("Whois").toUpperCase() == "Viewer".toUpperCase()) {
            //   $('#HR-div').show();
        } else {
            // $('#HR-div').hide();
        }
        if ($.LocalStorageHelper.Get("Whois").toUpperCase() == "MYSELF".toUpperCase()) {
        } else {
        }

        $('.ui-dialog-buttonpane').find('button:contains("Submit")').button('disable');

        $('#select_all').on('click', function () {
            if (this.checked) {
                $('.checkbox').each(function () {
                    this.checked = true;
                });
            } else {
                $('.checkbox').each(function () {
                    this.checked = false;
                });
            }
        });

        $('.checkbox').on('click', function () {
            alert('yyy');
            if ($('.checkbox:checked').length == $('.checkbox').length) {
                $('#select_all').prop('checked', true);
            } else {
                $('#select_all').prop('checked', false);
            }
        });


        $('#save').on('click', function (e) {
            var selecteditems = [];
            var authority = $('#authority').val();
            var reason;
            var isClose = $('#isClose').val();
            var approval; 
            if (authority.toUpperCase() == "SANCTION") {
                reason = $('#Grid-ReasonSanction').val();
                approval = $('input[name="Sanction"]:checked').val();
            }
            else if (authority.toUpperCase() == "APPROVAL") {
                reason = $('#Grid-ReasonApproval').val();
                approval = $('input[name="Approval"]:checked').val();
            }
            else{ reason = "";}
           
            
            $("#monthTable").find("input:checked").each(function (i, ob) {
                selecteditems.push($(ob).val());
            });
            $.ajax({
                url: "@Url.Action("Update_TargetReqMultiple", "TargetEntryForm")",
                method: "POST",
                cache: false,
                contentType: 'application/json',
                datatype: 'json',
                data: JSON.stringify({ SelectedIds: selecteditems, authority: authority, reason: reason, isClose: isClose, approval: approval }),
                success: function (data) {
                    alert(data.responseText);
                    $.ajax({
                        url: "@Url.Action("GetEmpTargetData", "TargetEntryForm")",
                        method: "POST",
                        cache: false,
                        contentType: 'application/json',
                        datatype: 'json',
                        data: JSON.stringify({ data: $('#EmpDataTar').val()}),
                        success: function (data) {
                            var tr = "";
                            var index = 1;
                            var tempclass = "";
                            $('#monthTable tr:gt(0)').remove();
                            $.each(data[0], function (l, k) {
                                $('#isClose').val(k.IsClose);
                                tr += "<tr class='" + tempclass + "' id='" + index + "'><td>" + index + "</td><td><input type='checkbox' value='" + k.Id + "' id=chk'" + index + "'/></td><td>" + k.Category + "</td><td>" + k.SubCategory + "</td><td>" + k.Amount + "</td><td>" + k.Accounts + "</td><td>" + k.Compliance + "</td><td>" + k.Narration + "</td><td>" + k.CustomerId + "</td><td>" + k.AccountNo + "</td><td>" + k.Id + "</td></tr>";
                                index++;
                                tempclass = "";
                            });


                            $('#monthTable tr:last').after(tr);
                        }
                    });
                    
                }
            });
            e.preventDefault();
        });
        //} else {
        //    $('#HR-div').hide(); $('#Approval-div').hide(); $('#ReComandtion-div').hide(); $('#Sanction-div').hide();
        //}
        //var SelectId = "";
        //var formjson = "";
        @*$('#monthTable').on('click', 'tr:gt(0)', function (e) {
            var target = $(e.target).parent('tr');
            target.toggleClass('monthTable-selected');
            $('#monthTable tr:gt(0)').not(target).removeClass('monthTable-selected');
            $.each(target, function (i, k) {
                var childs = $(k).children().toArray();
                SelectId = ($(childs[10]).text());


            });
            $('.ui-dialog-buttonpane').find('button:contains("Submit")').button('enable');
            $.ajax({
                url: "@Url.Action("BA_Category_Id", "TargetEntryForm")",
                method: "POST",
                cache: false,
                contentType: 'application/json',
                datatype: 'json',
                data: JSON.stringify({ data: formjson, SelectId: SelectId }),
                success: function (data) {

                }
            });
            e.preventDefault();

            //alert(SelectId)    

        });*@

        
    });
   
    

</script>